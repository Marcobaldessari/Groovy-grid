function spring(){this.height=h-water_level,this.speed=0,this.update=function(){var t=h-water_level-this.height;this.speed+=tension*t-this.speed*dampen,this.height+=this.speed,this.height>h&&(this.height=h)}}function animate(){ctx.clearRect(0,0,w,h);for(var t=0;t<drops.length;t++)drops[t].update();var t;for(t=0;t<water.length;t++)water[t].update();for(var e=new Array(water.length),i=new Array(water.length),s=0;s<8;s++){for(t=0;t<water.length;t++)t>0&&(e[t]=k*(water[t].height-water[t-1].height),water[t-1].speed+=e[t]),t<water.length-1&&(i[t]=k*(water[t].height-water[t+1].height),water[t+1].speed+=i[t]);for(t=0;t<water[t].length;t++)t>0&&(water[t-1].height+=e[t]),t<water.length-1&&(water[t+1].height+=i[t])}ctx.strokeStyle="black",ctx.beginPath(),ctx.moveTo(0,water[0].height);for(var t=0;t<water.length;t++)ctx.lineTo((t+1)*(w/res),water[t].height);ctx.stroke(),window.requestAnimationFrame(animate)}var c=document.getElementById("canvas"),w=window.innerWidth,h=window.innerHeight,ctx=c.getContext("2d"),mouse,drops=[],shower=!1,water=[],water_level=250;res=100,k=.0025,tension=.01,dampen=.02,c.width=w,c.height=h;for(var i=0;i<res;i++)water[i]=new spring;animate(),dropplet=function(t,e){this.x=t,this.y=e,this.vel=10*Math.random()-5,this.col=Math.floor(res/w*this.x),this.update=function(){this.vel=.7*this.vel,this.y=this.y+1.5*Math.random()+1,this.x=this.x+this.vel,this.col=Math.floor(res/w*this.x),this.x<=0||this.x>=w||this.y<=h||this.y<=water[this.col].height?(ctx.beginPath(),ctx.arc(this.x,this.y,1.5,0,2*Math.PI,!1),ctx.fillStyle="#28d9e2",ctx.fill()):(this.destroy(),this.col>=0&&this.col<water.length&&(water_level+=.1,water[this.col].speed=5))},this.destroy=function(){drops.splice(drops.indexOf(this),1)}},document.addEventListener("mousemove",function(t){mouse=new function(){this.x=t.clientX-c.getBoundingClientRect().left,this.y=t.clientY-c.getBoundingClientRect().top,this.col=Math.floor(res/w*this.x)},console.log(mouse.col),mouse.y==Math.floor(water[5].height)&&(water[5].speed=water[5].speed+10)},!1),c.addEventListener("click",function(){drops.push(new dropplet(mouse.x,mouse.y))},!1);